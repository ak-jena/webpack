!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).wcr={})}(this,(function(t){"use strict";const e=t=>t.includes("/")?"/"===t.charAt(0)?t.substring(1).split("/"):t.split("/"):[t],o=document.createElement.bind(document),n=history.pushState.bind(history),i=history.replaceState.bind(history),s=window.removeEventListener.bind(window),r=window.dispatchEvent.bind(window),u=window.addEventListener.bind(window),a={Router:{NoRoutes:"Router :: No routes were defined!"},RouteMixin:{NoRoute:"RouteMixin :: `navigate` method requires the ### component to have a route property/attribute"}},c=()=>window.location.pathname||"/";t.RouteMixin=t=>class extends t{static get properties(){return{isRouteActive:Boolean}}connectedCallback(){super.connectedCallback(),this.isRouteActive=this.route===window.location.pathname,u("popstate",this.__handleActive.bind(this))}disconnectedCallback(){super.disconnectedCallback(),s("popstate",this.__handleActive.bind(this))}__handleActive(t){this.isRouteActive=t.state.route===this.route}navigate(t){const e=t||this.route;if(!e)throw a.RouteMixin.NoRoute.replace("###",this.nodeName);if(e===window.location.pathname)return;if("/"!==e.substring(0,1))return void(window.location.href=e);const o={route:e};n(o,null,e),r(new PopStateEvent("popstate",{state:o}))}},t.Router=t=>class extends t{static get properties(){return{routes:Array,route:String,routeProps:Object,routeElement:String,lastRoute:String}}constructor(){super();const t=c();this.routeProps={},this.lastRoute=null,i({route:t},null,t)}connectedCallback(){super.connectedCallback(),u("popstate",this.__handleNav.bind(this)),r(new PopStateEvent("popstate",{state:{route:c()}}))}disconnectedCallback(){super.disconnectedCallback(),s("popstate",this.__handleNav.bind(this))}__handleNav(t){if(!this.constructor.routes)throw a.Router.NoRoutes;const o=t.state.route,n=((t,o)=>{const n=t.find(({path:t})=>t===o);if(n)return{route:n,props:null};const i=t.find(t=>"*"===t.path),s=e(o),r={},u=t.find(({path:t})=>{const o=e(t);if(!Array.isArray(o))return!1;const n=o.filter(t=>!t.includes(":?")).length;return!(o[0].includes(":")||s.length<n||s.length>o.length)&&o.every((t,e)=>o[e].includes(":?")?(r[o[e].replace(":?","")]=s[e],!0):o[e].includes(":")?(r[o[e].replace(":","")]=s[e],!0):t===s[e])});return!u&&i?{route:i}:u||i?{route:u,props:r}:null})(this.constructor.routes,o);n&&(this.route=n.route,this.routeProps=n.props),this.lastRoute!==o&&(this.setRouteElement(),this.lastRoute=o)}setRouteElement(){const t=()=>{let t;"function"==typeof this.route.render?t=this.route.render(this.routeProps):(t=o(this.route.component),Object.assign(t,this.routeProps)),this.routeElement=t};this.route?customElements.get(this.route.component)||"function"!=typeof this.route.import?t():this.route.import().then(t):this.routeElement=null}},Object.defineProperty(t,"__esModule",{value:!0})}));
